{
  "collection": "gateway_client_access_control",
  "comment": "Indexes for Client Access Control MongoDB collection",
  "indexes": [
    {
      "name": "idx_client_id_unique",
      "keys": {
        "clientId": 1
      },
      "options": {
        "unique": true,
        "background": false,
        "comment": "Unique index on clientId for fast lookup and uniqueness enforcement"
      }
    },
    {
      "name": "idx_active_clients",
      "keys": {
        "isActive": 1
      },
      "options": {
        "background": false,
        "comment": "Index for filtering active clients"
      }
    },
    {
      "name": "idx_tenant",
      "keys": {
        "tenant": 1
      },
      "options": {
        "background": false,
        "comment": "Index for tenant-based queries"
      }
    },
    {
      "name": "idx_timestamps",
      "keys": {
        "updatedAt": -1,
        "createdAt": -1
      },
      "options": {
        "background": false,
        "comment": "Compound index for timestamp-based queries (descending order for recent-first)"
      }
    }
  ],
  "validationLevel": "strict",
  "validationAction": "error",
  "validator": {
    "$jsonSchema": {
      "bsonType": "object",
      "required": ["clientId", "tenant", "isActive", "isDeleted", "createdAt", "updatedAt"],
      "properties": {
        "clientId": {
          "bsonType": "string",
          "minLength": 3,
          "maxLength": 128,
          "pattern": "^[a-zA-Z0-9._-]+$",
          "description": "Client ID must be 3-128 alphanumeric characters with ._- allowed"
        },
        "description": {
          "bsonType": "string",
          "maxLength": 512,
          "description": "Human-readable description of the client"
        },
        "tenant": {
          "bsonType": "string",
          "maxLength": 256,
          "description": "Tenant/organization identifier"
        },
        "isActive": {
          "bsonType": "bool",
          "description": "Active status flag"
        },
        "isDeleted": {
          "bsonType": "bool",
          "description": "Soft delete flag"
        },
        "allow": {
          "bsonType": "array",
          "items": {
            "bsonType": "string"
          },
          "description": "Array of allow/deny rules in service:route format"
        },
        "createdAt": {
          "bsonType": "date",
          "description": "Creation timestamp"
        },
        "updatedAt": {
          "bsonType": "date",
          "description": "Last update timestamp"
        },
        "deletedAt": {
          "bsonType": ["date", "null"],
          "description": "Deletion timestamp (null if not deleted)"
        }
      }
    }
  }
}
